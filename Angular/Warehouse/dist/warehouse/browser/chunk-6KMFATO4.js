import{a as N}from"./chunk-FYVEFPOD.js";import{a as O,b as h,c as U,d as q,e as $,f as G,g as H,h as z,m as B,o as Y,p as J}from"./chunk-5YPTTVOM.js";import{$ as i,G as C,H as d,Ia as M,K as p,Ka as y,L as F,La as k,P as f,S as s,Va as w,Xa as L,_ as r,aa as m,ba as x,ca as v,da as u,ea as A,fa as D,ga as o,ha as P,ia as S,pa as R,s as b,v as g,w as _,wa as V,xa as j,za as I}from"./chunk-S7MPL5EF.js";function ee(a,t){if(a&1){let e=x();r(0,"div",15)(1,"div",16)(2,"div"),m(3,"img",17),r(4,"div",18)(5,"h3",19),o(6),i(),r(7,"p",20),o(8),i(),r(9,"p",21),o(10),i(),r(11,"p",22),o(12),i(),r(13,"div")(14,"button",23),v("click",function(){let l=g(e).$implicit,c=u();return _(c.editProduct(l.product_id))}),o(15,"Edit"),i(),r(16,"button",24),v("click",function(){let l=g(e).$implicit,c=u();return _(c.deleteProduct(l.product_id))}),o(17,"Delete"),i()()()()()()}if(a&2){let e=t.$implicit,n=u();d(3),A("alt",e.product_name),s("src",n.getImageUrl(e),C),d(3),P(e.product_name),d(2),P(e.product_Desc),d(2),S("Price: ",e.product_price,""),d(2),S("Stock: ",e.product_stocks,"")}}var T=class a{constructor(t,e,n){this.router=t;this.toastr=e;this.authService=n}apiService=b(N);products=[];ngOnInit(){this.getProduct()}getProduct(){this.apiService.getProducts().subscribe({next:t=>{this.products=t},error:t=>{this.toastr.error("Failed to get Product"),console.error("failed to get product")}})}editProduct(t){this.router.navigate([`admin/edit_products/${t}`])}deleteProduct(t){confirm("Are you sure you want to delete this product?")&&this.apiService.deleteProduct(t).subscribe({next:()=>{this.toastr.success("Product Deleted Successfully"),this.getProduct()},error:e=>{this.toastr.error(e.error?.message||"Failed to Delete product"),console.error("Failed to delete product",e)}})}getImageUrl(t){return t.image_data?`data:${t.image_type};base64,${t.image_data}`:"public/truck.jpg"}logout(){this.authService.logout()}static \u0275fac=function(e){return new(e||a)(p(y),p(w),p(L))};static \u0275cmp=F({type:a,selectors:[["app-admin"]],decls:21,vars:1,consts:[[1,"navbar","navbar-expand-lg","bg-warning"],[1,"container-fluid"],["href","#",1,"navbar-brand"],["type","button","data-bs-toggle","collapse","data-bs-target","#navbarNav","aria-controls","navbarNav","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbarNav",1,"collapse","navbar-collapse"],[1,"navbar-nav"],[1,"nav-item"],["routerLink","/admin/products",1,"nav-link","active"],["routerLink","/admin/create_products",1,"nav-link","text-black"],[1,"d-flex","justify-content-end","align-items-end","me-5"],[1,"btn","btn-danger",2,"cursor","pointer",3,"click"],[1,"container","my-4"],[1,"row"],["class","col-3 mb-3",4,"ngFor","ngForOf"],[1,"col-3","mb-3"],[1,"card",2,"width","18rem"],["height","288px","width","288px",1,"card-image-top",3,"src","alt"],[1,"card-body"],[1,"card-title"],[1,"card-text","text-danger"],[1,"card-text","fw-bold","text-primary"],[1,"card-text","fw-bold","text-success"],["type","button",1,"btn","btn-success","me-3",3,"click"],["type","button",1,"btn","btn-danger",3,"click"]],template:function(e,n){e&1&&(r(0,"nav",0)(1,"div",1)(2,"a",2),o(3,"Admin"),i(),r(4,"button",3),m(5,"span",4),i(),r(6,"div",5)(7,"ul",6)(8,"li",7)(9,"a",8),o(10,"Home"),i()(),r(11,"li",7)(12,"a",9),o(13,"Add Products"),i()()()(),r(14,"div",10)(15,"a",11),v("click",function(){return n.logout()}),o(16,"Logout"),i()()()(),r(17,"section")(18,"div",12)(19,"div",13),f(20,ee,18,6,"div",14),i()()()),e&2&&(d(20),s("ngForOf",n.products))},dependencies:[I,V,k],encapsulation:2})};function te(a,t){a&1&&(r(0,"div",30),o(1,"Product Name is Required "),i())}function ie(a,t){a&1&&(r(0,"div",30),o(1,"Product Price is Required "),i())}function re(a,t){a&1&&(r(0,"div",30),o(1,"Product Stock is Required "),i())}function oe(a,t){if(a&1&&(r(0,"div",16)(1,"label",31),o(2,"Image Preview"),i(),m(3,"img",32),i()),a&2){let e=u(2);d(3),s("src",e.imagePreview,C)}}function ne(a,t){if(a&1){let e=x();r(0,"div",14)(1,"h2"),o(2),i(),r(3,"form",15),v("ngSubmit",function(){g(e);let l=u();return _(l.onSubmit())}),r(4,"div",16)(5,"label",17),o(6,"Product Name"),i(),m(7,"input",18),f(8,te,2,0,"div",19),i(),r(9,"div",16)(10,"label",20),o(11,"Product Description"),i(),m(12,"textarea",21),i(),r(13,"div",16)(14,"label",22),o(15,"Product Price"),i(),m(16,"input",23),f(17,ie,2,0,"div",19),i(),r(18,"div",16)(19,"label",24),o(20,"Product Stock"),i(),m(21,"input",25),f(22,re,2,0,"div",19),i(),r(23,"div",16)(24,"label",26),o(25,"Product Image"),i(),r(26,"input",27),v("change",function(l){g(e);let c=u();return _(c.onFileSelected(l))}),i()(),f(27,oe,4,1,"div",28),r(28,"button",29),o(29),i()()()}if(a&2){let e,n,l,c=u();d(2),P(c.isEdit?"Update Product":"Create Product"),d(),s("formGroup",c.productForm),d(5),s("ngIf",((e=c.productForm.get("product_name"))==null?null:e.touched)&&((e=c.productForm.get("product_name"))==null?null:e.invalid)),d(9),s("ngIf",((n=c.productForm.get("product_price"))==null?null:n.touched)&&((n=c.productForm.get("product_price"))==null?null:n.invalid)),d(5),s("ngIf",((l=c.productForm.get("product_stocks"))==null?null:l.touched)&&((l=c.productForm.get("product_stocks"))==null?null:l.invalid)),d(5),s("ngIf",c.imagePreview),d(),s("disabled",c.productForm.invalid||c.isLoading),d(),S("",c.isEdit?"Update":"Create"," Product")}}function ae(a,t){a&1&&m(0,"app-spinner")}var E=class a{constructor(t,e,n){this.route=t;this.router=e;this.toastr=n}fb=b(B);apiService=b(N);authService=b(L);productForm=this.fb.group({product_name:["",h.required],product_Desc:[""],product_price:[0,[h.required,h.minLength(0)]],product_stocks:[0,[h.required,h.minLength(0)]]});isEdit=!1;productId;selectedFile=null;imagePreview=null;isLoading=!1;ngOnInit(){this.route.params.subscribe(t=>{t.id&&(this.isEdit=!0,this.productId=+t.id,this.loadProduct(this.productId))})}loadProduct(t){this.isLoading=!0,this.apiService.getProductId(t).subscribe({next:e=>{this.productForm.patchValue({product_name:e.product_name,product_Desc:e.product_Desc,product_price:e.product_price,product_stocks:e.product_stocks}),this.isLoading=!1},error:e=>{this.toastr.error(e.error?.message||"Failed to load  product"),this.isLoading=!1}})}onFileSelected(t){let e=t.target;if(e.files&&e.files.length>0){this.selectedFile=e.files[0];let n=new FileReader;n.onload=()=>{this.imagePreview=n.result},n.readAsDataURL(this.selectedFile)}}onSubmit(){this.isLoading=!0;let t=this.productForm.value,e={product_name:t.product_name??"",product_Desc:t.product_Desc??"",product_price:t.product_price??0,product_stocks:t.product_stocks??0};this.isEdit&&this.productId?this.selectedFile?this.apiService.updateProduct(this.productId,e,this.selectedFile).subscribe({next:()=>{this.toastr.success("Product updated successfully"),this.router.navigate(["admin/products"]),this.isLoading=!1},error:n=>{this.toastr.error("Product update failed"),console.log("please select file"),this.isLoading=!1}}):(this.toastr.error("Please select a file before submitting"),console.log("please select file"),this.isLoading=!1):this.selectedFile?(console.log(this.selectedFile.name),this.apiService.createProduct(e,this.selectedFile).subscribe({next:()=>{console.log("success"),this.toastr.success("Product Created Succesfully"),this.router.navigate(["admin/products"])},error:n=>{debugger;this.toastr.error(n.error?.message||"Failed to Create Product"),console.log("please select file before creating from error"),this.isLoading=!1}})):(this.toastr.error("Please select a file before creating"),console.log("please select file before creating from else"),this.isLoading=!1),this.productForm.invalid}logout(){this.authService.logout()}static \u0275fac=function(e){return new(e||a)(p(M),p(y),p(w))};static \u0275cmp=F({type:a,selectors:[["app-product-form"]],decls:20,vars:2,consts:[["loading",""],[1,"navbar","navbar-expand-lg","bg-warning"],[1,"container-fluid"],["href","#",1,"navbar-brand"],["type","button","data-bs-toggle","collapse","data-bs-target","#navbarNav","aria-controls","navbarNav","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbarNav",1,"collapse","navbar-collapse"],[1,"navbar-nav"],[1,"nav-item"],["routerLink","/admin/products",1,"nav-link","active"],["routerLink","/admin/products",1,"nav-link","text-white"],[1,"d-flex","justify-content-end","align-items-end","me-5"],[1,"btn","btn-danger",2,"cursor","pointer",3,"click"],["class","container mt-4",4,"ngIf","ngIfElse"],[1,"container","mt-4"],["enctype","multipart/form-data",3,"ngSubmit","formGroup"],[1,"mb-3"],["for","product_name",1,"form-label"],["type","text","formControlName","product_name","placeholder","Enter Product Name","id","product_name",1,"form-control"],["class","text-danger",4,"ngIf"],["for","product_Desc",1,"form-label"],["type","text","formControlName","product_Desc","placeholder","Enter Product Description","id","product_Desc",1,"form-control"],["for","product_price",1,"form-label"],["type","number","formControlName","product_price","placeholder","Enter Product Price","id","product_price",1,"form-control"],["for","product_stocks",1,"form-label"],["type","number","formControlName","product_stocks","placeholder","Enter Product Stock","id","product_stocks",1,"form-control"],["for","image",1,"form-label"],["type","file","id","image",1,"form-control",3,"change"],["class","mb-3",4,"ngIf"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"text-danger"],["for","",1,"form-label"],["alt","preview","width","200",1,"img-thumbnail",3,"src"]],template:function(e,n){if(e&1){let l=x();r(0,"nav",1)(1,"div",2)(2,"a",3),o(3,"Admin"),i(),r(4,"button",4),m(5,"span",5),i(),r(6,"div",6)(7,"ul",7)(8,"li",8)(9,"a",9),o(10,"Home"),i()(),r(11,"li",8)(12,"a",10),o(13," Products List"),i()()()(),r(14,"div",11)(15,"a",12),v("click",function(){return g(l),_(n.logout())}),o(16,"Logout"),i()()()(),f(17,ne,30,8,"div",13)(18,ae,1,0,"ng-template",null,0,R)}if(e&2){let l=D(19);d(17),s("ngIf",!n.isLoading)("ngIfElse",l)}},dependencies:[I,j,Y,$,O,G,U,q,H,z,J,k],encapsulation:2})};var Te=[{path:"",redirectTo:"products",pathMatch:"full"},{path:"products",component:T,title:"Products",data:{roles:["ROLE_BUYER"]}},{path:"create_products",component:E,title:"Create Product"},{path:"edit_products/:id",component:E,data:{renderMode:"client",ssr:!1},title:"Edit Product"}];export{Te as ADMIN_ROUTES};
