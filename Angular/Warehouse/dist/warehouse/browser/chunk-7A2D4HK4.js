import{a as D}from"./chunk-FYVEFPOD.js";import{a as st,b as L,c as z,d as J,e as K,g as Q,h as W,i as X,j as Y,k as Z,m as tt,o as et,p as N}from"./chunk-5YPTTVOM.js";import{$ as t,H as s,Ia as H,K as u,Ka as I,L as C,La as y,P as p,S,T as E,U as B,V as rt,Va as F,W as c,X as R,Xa as k,Y as f,Z as b,_ as n,aa as _,ba as ot,ca as v,da as g,ga as r,ha as h,ia as T,ja as at,na as j,oa as q,s as d,v as $,w as G,ya as U,za as x}from"./chunk-S7MPL5EF.js";function ct(a,i){if(a&1){let e=ot();n(0,"tr")(1,"td"),r(2),t(),n(3,"td"),r(4),t(),n(5,"td"),r(6),t(),n(7,"td")(8,"span"),r(9),t()(),n(10,"td"),r(11),t(),n(12,"td"),r(13),t(),n(14,"td")(15,"button",14),v("click",function(){let l=$(e).$implicit,m=g(2);return G(m.editShipments(l.transId))}),r(16,"Edit"),t(),n(17,"button",15),v("click",function(){let l=$(e).$implicit,m=g(2);return G(m.updateStatus(l.transId))}),r(18,"Status"),t(),n(19,"button",16),v("click",function(){let l=$(e).$implicit,m=g(2);return G(m.deleteShipments(l.transId))}),r(20,"Delete"),t()()()}if(a&2){let e=i.$implicit,o=g(2);s(2),h(e.transId),s(2),h(e.order.order_id),s(2),h(e.method),s(2),B(o.getStatusBadgeclass(e.status)),s(),T(" ",e.status," "),s(2),h(e.trackingNumber||"N/A"),s(2),h(e.estimatedDelivery||"N/A")}}function vt(a,i){a&1&&(n(0,"div",12)(1,"table",13)(2,"thead")(3,"tr")(4,"th"),r(5,"ID"),t(),n(6,"th"),r(7,"Order ID"),t(),n(8,"th"),r(9,"Method"),t(),n(10,"th"),r(11,"Status"),t(),n(12,"th"),r(13,"Tracking No."),t(),n(14,"th"),r(15,"Estimated Delivery"),t(),n(16,"th"),r(17,"Actions"),t()()(),n(18,"tbody"),f(19,ct,21,8,"tr",null,rt().trackById,!0),t()()()),a&2&&(s(19),b(i))}function ht(a,i){a&1&&_(0,"app-spinner")}var it=class a{constructor(i,e){this.router=i;this.toast=e}authService=d(k);apiService=d(D);shipments$=this.apiService.getTransport();editShipments(i){this.router.navigate([`/transport/edit_shipments/${i}`])}updateStatus(i){this.router.navigate([`/transport/shipments_status/${i}`])}deleteShipments(i){confirm("Are you sure you want to delete this shipments?")&&this.apiService.deleteTransport(i).subscribe({next:()=>{this.shipments$=this.apiService.getTransport(),this.toast.success("Shipment Deleted Successfully")},error:e=>{this.toast.error("Failed to delete shipment")}})}getStatusBadgeclass(i){switch(i){case"PENDING":return"badge bg-warning text-dark";case"IN_TRANSIT":return"badge bg-info text-dark";case"DELIVERED":return"badge bg-success";case"CANCELLED":return"badge bg-danger";case"PREPARING":return"badge bg-primary";default:return"badge bg-secondary"}}trackById(i,e){return e.transId??i}logout(){this.authService.logout()}static \u0275fac=function(e){return new(e||a)(u(I),u(F))};static \u0275cmp=C({type:a,selectors:[["app-transport-list"]],decls:24,vars:3,consts:[[1,"navbar","navbar-expand-lg","navbar-dark","bg-dark"],[1,"container"],["routerLink","/",1,"navbar-brand"],["id","navbarNav",1,"collapse","navbar-collapse"],[1,"navbar-nav"],[1,"nav-item"],["routerLink","/transport/shipments",1,"nav-link","active"],["routerLink","/transport/shipments",1,"nav-link","text-white"],["id","navbar-item",1,"navbar-nav"],[1,"nav-link","btn-primary","btn",3,"click"],[1,"container","mt-4"],["routerLink","/transport/create_shipments","type","button",1,"btn","btn-info","mb-3"],[1,"table-responsive"],[1,"table","table-striped"],["type","button",1,"btn","btn-info","me-2","btn-sm",3,"click"],["type","button",1,"btn","btn-warning","btn-sm","me-2",3,"click"],["type","button",1,"btn","btn-sm","btn-danger",3,"click"]],template:function(e,o){if(e&1&&(n(0,"nav",0)(1,"div",1)(2,"a",2),r(3,"Inventory Management"),t(),n(4,"div",3)(5,"ul",4)(6,"li",5)(7,"a",6),r(8,"Home"),t()(),n(9,"li",5)(10,"a",7),r(11,"Shipments"),t()()()(),n(12,"ul",8)(13,"li",5)(14,"a",9),v("click",function(){return o.logout()}),r(15,"Logout"),t()()()()(),n(16,"div",10)(17,"h2"),r(18,"Transportation Management"),t(),n(19,"button",11),r(20,"Add New Shipment"),t(),p(21,vt,21,0,"div",12),j(22,"async"),p(23,ht,1,0,"app-spinner"),t()),e&2){let l;s(21),c((l=q(22,1,o.shipments$))?21:23,l)}},dependencies:[x,U,y,N],encapsulation:2})};var ft=(a,i)=>i.order_id;function bt(a,i){if(a&1&&(n(0,"option",19),r(1),t()),a&2){let e=i.$implicit;S("value",e.order_id),s(),at("Order ",e.order_id," - ",e.buyer.name,"")}}function _t(a,i){a&1&&f(0,bt,2,3,"option",19,ft),a&2&&b(i)}function gt(a,i){a&1&&(n(0,"div",16),r(1,"Order is required"),t())}function Tt(a,i){if(a&1&&(n(0,"option",19),r(1),t()),a&2){let e=i.$implicit;S("value",e),s(),h(e)}}function Ct(a,i){a&1&&(n(0,"div",16),r(1,"Method is required"),t())}function Et(a,i){if(a&1&&(n(0,"option",19),r(1),t()),a&2){let e=i.$implicit;S("value",e),s(),h(e)}}function xt(a,i){a&1&&(n(0,"div",16),r(1,"Method is required"),t())}function It(a,i){a&1&&_(0,"app-spinner")}function yt(a,i){if(a&1&&r(0),a&2){let e=g();T(" ",e.isEdit?"Updated":"Save"," ")}}var A=class a{constructor(i,e,o){this.route=i;this.router=e;this.toastr=o}fb=d(tt);apiService=d(D);authService=d(k);transportForm=this.fb.group({order_id:[0,L.required],status:["",L.required],method:["",L.required],estimatedDelivery:[""]});isEdit=!1;transId;isLoading=!1;transportMethods=["ROAD","AIR","SEA"];transportStatus=["PREPARING","IN_TRANSIT","DELIVERED","CANCELLED","dharshan"];orders$=this.apiService.getOrders();ngOnInit(){this.route.params.subscribe(i=>{i.id?(this.isEdit=!0,this.transId=+i.id,console.log("transid",this.transId),this.loadShipments(this.transId)):console.log("error")})}loadShipments(i){this.isLoading=!0,this.apiService.getTransportId(i).subscribe({next:e=>{this.transportForm.patchValue({order_id:e.order.order_id,method:e.method,status:e.status,estimatedDelivery:e.estimatedDelivery.toString().split("T")[0]||""}),this.isLoading=!1},error:e=>{this.toastr.error(e.error?.message||"Faild to load shipments"),this.isLoading=!1}})}onSubmit(){this.isLoading=!0;let i=this.transportForm.value;console.log("FormValue",i.order_id),this.orders$.subscribe(e=>{console.log("before selected ",e);let o=e.find(m=>m.order_id===+i.order_id);if(console.log("selected ",o?.order_id),!o){this.toastr.error("Selected order not found"),this.isLoading=!1;return}let l={order:o,method:i.method??"",estimatedDelivery:i.estimatedDelivery??""};this.isEdit&&this.transId?this.apiService.updateTransport(this.transId,l).subscribe({next:()=>{this.toastr.success("Shipment updated Successfully"),this.router.navigate(["transport/shipments"])},error:m=>{this.toastr.error(m.error?.message||"Failed to update Shipments"),this.isLoading=!1}}):this.apiService.createTransport(l).subscribe({next:()=>{this.toastr.success("Shipment Created Successfully"),this.router.navigate(["transport/shipments"])},error:m=>{this.toastr.error(m.error?.message||"Failed to Create Shipments"),this.isLoading=!1}})}),this.transportForm.invalid}logout(){this.authService.logout()}static \u0275fac=function(e){return new(e||a)(u(H),u(I),u(F))};static \u0275cmp=C({type:a,selectors:[["app-transport-form"]],decls:56,vars:16,consts:[[1,"navbar","navbar-expand-lg","navbar-dark","bg-dark"],[1,"container"],["routerLink","/",1,"navbar-brand"],["id","navbarNav",1,"collapse","navbar-collapse"],[1,"navbar-nav"],[1,"nav-item"],["routerLink","/transport/shipments",1,"nav-link","active"],["routerLink","/transport/shipments",1,"nav-link","text-white"],["id","navbar-item",1,"navbar-nav"],[1,"nav-link","btn-primary","btn",3,"click"],[1,"container","mt-4"],[3,"ngSubmit","formGroup"],[1,"mb-3"],["for","order_id",1,"form-label"],["formControlName","order_id","id","order_id",1,"form-select"],["value",""],[1,"text-danger"],["for","method",1,"form-label"],["formControlName","method","id","method",1,"form-select"],[3,"value"],["for","status",1,"form-label"],["formControlName","status","id","status",1,"form-select"],["for","estimatedDelivery",1,"form-label"],["type","date","id","estimatedDelivery","formControlName","estimatedDelivery",1,"form-control"],["type","submit",1,"btn","btn-info","me-2",3,"disabled"],["type","button","routerLink","/transport/shipments",1,"btn","btn-danger"]],template:function(e,o){if(e&1&&(n(0,"nav",0)(1,"div",1)(2,"a",2),r(3,"Inventory Management"),t(),n(4,"div",3)(5,"ul",4)(6,"li",5)(7,"a",6),r(8,"Home"),t()(),n(9,"li",5)(10,"a",7),r(11,"Shipments"),t()()()(),n(12,"ul",8)(13,"li",5)(14,"a",9),v("click",function(){return o.logout()}),r(15,"Logout"),t()()()()(),n(16,"div",10)(17,"h2"),r(18),t(),n(19,"form",11),v("ngSubmit",function(){return o.onSubmit()}),n(20,"div",12)(21,"label",13),r(22,"Order"),t(),n(23,"select",14)(24,"option",15),r(25,"Select an Order"),t(),p(26,_t,2,0),j(27,"async"),t(),p(28,gt,2,0,"div",16),t(),n(29,"div",12)(30,"label",17),r(31,"Transport Method"),t(),n(32,"select",18)(33,"option",15),r(34,"Select a Method"),t(),f(35,Tt,2,2,"option",19,R),t(),p(37,Ct,2,0,"div",16),t(),n(38,"div",12)(39,"label",20),r(40,"Transport Status"),t(),n(41,"select",21)(42,"option",15),r(43,"Select a Status"),t(),f(44,Et,2,2,"option",19,R),t(),p(46,xt,2,0,"div",16),t(),n(47,"div",12)(48,"label",22),r(49,"EstimatedDelivery"),t(),_(50,"input",23),t(),n(51,"button",24),p(52,It,1,0,"app-spinner")(53,yt,1,1),t(),n(54,"button",25),r(55,"Cancel"),t()()()),e&2){let l,m,M,w,O,V,P;s(18),T("",o.isEdit?"Edit":"Add"," Shipments"),s(),S("formGroup",o.transportForm),s(4),E("is-invalid",((l=o.transportForm.get("order_id"))==null?null:l.invalid)&&((l=o.transportForm.get("order_id"))==null?null:l.touched)),s(3),c((m=q(27,14,o.orders$))?26:-1,m),s(2),c((M=o.transportForm.get("order_id"))!=null&&M.invalid&&((M=o.transportForm.get("order_id"))!=null&&M.touched)?28:-1),s(4),E("is-invalid",((w=o.transportForm.get("method"))==null?null:w.invalid)&&((w=o.transportForm.get("method"))==null?null:w.touched)),s(3),b(o.transportMethods),s(2),c((O=o.transportForm.get("method"))!=null&&O.invalid&&((O=o.transportForm.get("method"))!=null&&O.touched)?37:-1),s(4),E("is-invalid",((V=o.transportForm.get("status"))==null?null:V.invalid)&&((V=o.transportForm.get("status"))==null?null:V.touched)),s(3),b(o.transportStatus),s(2),c((P=o.transportForm.get("order_id"))!=null&&P.invalid&&((P=o.transportForm.get("order_id"))!=null&&P.touched)?46:-1),s(5),S("disabled",o.transportForm.invalid||o.isLoading),s(),c(o.isLoading?52:53)}},dependencies:[x,U,et,K,Y,Z,st,X,z,J,Q,W,N,y],encapsulation:2})};function Ft(a,i){if(a&1&&(n(0,"option",19),r(1),t()),a&2){let e=i.$implicit;S("value",e),s(),h(e)}}function kt(a,i){a&1&&(n(0,"div",20),r(1,"Status is required"),t())}function Lt(a,i){a&1&&_(0,"app-spinner")}function Nt(a,i){a&1&&r(0," Update Status ")}var nt=class a{constructor(i,e,o){this.route=i;this.router=e;this.toastr=o}fb=d(tt);apiService=d(D);authService=d(k);statusForm=this.fb.group({status:["",L.required]});shipmentId;currentStatus="";statusOptions=["PENDING","IN_TRANSIT","CANCELLED","PREPARING","DELIVERED"];isLoading=!1;ngOnInit(){this.route.params.subscribe(i=>{this.shipmentId=+i.id,this.loadShipments(this.shipmentId)})}loadShipments(i){this.isLoading=!0,this.apiService.getTransportId(i).subscribe({next:e=>{this.currentStatus=e.status,this.statusForm.patchValue({status:e.status}),this.isLoading=!1},error:e=>{this.toastr.error(e.error?.message||"Failed to load shipment"),this.isLoading=!1}})}onSubmit(){this.isLoading=!0;let i=this.statusForm.value.status;console.log("shipstatus:",i,this.shipmentId),this.apiService.updateStatusTransport(this.shipmentId,i).subscribe({next:e=>{console.log(e.status),this.toastr.success("Status Updated Successfully"),this.router.navigate(["/transport/shipments"])},error:e=>{this.toastr.error("Failed to Update Status"),this.isLoading=!1}}),this.statusForm.invalid}getStatusBadgeclass(i){switch(i){case"PENDING":return"badge bg-warning text-dark";case"IN_TRANSIT":return"badge bg-info text-dark";case"DELIVERED":return"badge bg-success";case"CANCELLED":return"badge bg-danger";case"PREPARING":return"badge bg-primary";default:return"badge bg-secondary"}}logout(){this.authService.logout()}static \u0275fac=function(e){return new(e||a)(u(H),u(I),u(F))};static \u0275cmp=C({type:a,selectors:[["app-transport-status"]],decls:40,vars:9,consts:[[1,"navbar","navbar-expand-lg","navbar-dark","bg-dark"],[1,"container"],["routerLink","/",1,"navbar-brand"],["id","navbarNav",1,"collapse","navbar-collapse"],[1,"navbar-nav"],[1,"nav-item"],["routerLink","/transport/shipments",1,"nav-link","active"],["routerLink","/transport/shipments",1,"nav-link","text-white"],["id","navbar-item",1,"navbar-nav"],[1,"nav-link","btn-primary","btn",3,"click"],[1,"container","mt-4"],[1,"card","mb-4"],[1,"card-body"],[1,"card-title"],[3,"ngSubmit","formGroup"],[1,"mb-3"],["for","status",1,"form-label"],["id","status","formControlName","status",1,"form-select"],["value",""],[3,"value"],[1,"text-danger"],["type","submit",1,"btn","btn-primary","me-2",3,"disabled"],["type","button","routerLink","/transport/shipments",1,"btn","btn-secondary"]],template:function(e,o){if(e&1&&(n(0,"nav",0)(1,"div",1)(2,"a",2),r(3,"Inventory Management"),t(),n(4,"div",3)(5,"ul",4)(6,"li",5)(7,"a",6),r(8,"Home"),t()(),n(9,"li",5)(10,"a",7),r(11,"Shipments"),t()()()(),n(12,"ul",8)(13,"li",5)(14,"a",9),v("click",function(){return o.logout()}),r(15,"Logout"),t()()()()(),n(16,"div",10)(17,"h2"),r(18,"Update Shipment Status"),t(),n(19,"div",11)(20,"div",12)(21,"h5",13),r(22,"Current Status"),t(),n(23,"span"),r(24),t()()(),n(25,"form",14),v("ngSubmit",function(){return o.onSubmit()}),n(26,"div",15)(27,"label",16),r(28,"New Status"),t(),n(29,"select",17)(30,"option",18),r(31,"Select a status"),t(),f(32,Ft,2,2,"option",19,R),t(),p(34,kt,2,0,"div",20),t(),n(35,"button",21),p(36,Lt,1,0,"app-spinner")(37,Nt,1,0),t(),n(38,"button",22),r(39," Cancel "),t()()()),e&2){let l,m;s(23),B(o.getStatusBadgeclass(o.currentStatus)),s(),T(" ",o.currentStatus," "),s(),S("formGroup",o.statusForm),s(4),E("is-invalid",((l=o.statusForm.get("status"))==null?null:l.invalid)&&((l=o.statusForm.get("status"))==null?null:l.touched)),s(3),b(o.statusOptions),s(2),c((m=o.statusForm.get("status"))!=null&&m.invalid&&((m=o.statusForm.get("status"))!=null&&m.touched)?34:-1),s(),S("disabled",o.statusForm.invalid||o.isLoading),s(),c(o.isLoading?36:37)}},dependencies:[x,et,K,Y,Z,X,z,J,Q,W,N,y],encapsulation:2})};var ve=[{path:"shipments",component:it,title:"Shipments"},{path:"create_shipments",component:A,title:"New Shipments"},{path:"edit_shipments/:id",component:A,data:{renderMode:"client",ssr:!1},title:"Edit Shipments"},{path:"shipments_status/:id",component:nt,data:{renderMode:"client",ssr:!1},title:"Update Shipment Status"},{path:"",redirectTo:"shipments",pathMatch:"full"}];export{ve as TRANSPORT_ROUTES};
