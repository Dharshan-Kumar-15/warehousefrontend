{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport { inject } from '@angular/core';\nimport { FormBuilder, ReactiveFormsModule, Validators } from '@angular/forms';\nimport { SpinnerComponent } from '../../../Others/spinner/spinner.component';\nimport { ApiService } from '../../../../Services/ApiService/api.service';\nimport { RouterLink } from '@angular/router';\nimport { AuthService } from '../../../../Services/AuthService/auth.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"ngx-toastr\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nconst _forTrack0 = ($index, $item) => $item.product_id;\nfunction WarehouseFormComponent_Conditional_28_For_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 21);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const product_r1 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", product_r1.product_id);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate2(\"\", product_r1.product_name, \" -Stock: \", product_r1.product_stocks, \"\");\n  }\n}\nfunction WarehouseFormComponent_Conditional_28_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵrepeaterCreate(0, WarehouseFormComponent_Conditional_28_For_1_Template, 2, 3, \"option\", 21, _forTrack0);\n  }\n  if (rf & 2) {\n    i0.ɵɵrepeater(ctx);\n  }\n}\nfunction WarehouseFormComponent_Conditional_30_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 16);\n    i0.ɵɵtext(1, \"Product is Required\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction WarehouseFormComponent_Conditional_35_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 16);\n    i0.ɵɵtext(1, \"Location is Required\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction WarehouseFormComponent_Conditional_37_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-spinner\");\n  }\n}\nfunction WarehouseFormComponent_Conditional_38_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0);\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.isEdit ? \"Update\" : \"Save\", \" Item \");\n  }\n}\nexport let WarehouseFormComponent = /*#__PURE__*/(() => {\n  class WarehouseFormComponent {\n    constructor(route, router, toastr) {\n      this.route = route;\n      this.router = router;\n      this.toastr = toastr;\n      this.fb = inject(FormBuilder);\n      this.apiService = inject(ApiService);\n      this.authService = inject(AuthService);\n      this.warehouseForm = this.fb.group({\n        product_id: [0, Validators.required],\n        quantity: [0, Validators.required],\n        location: ['', Validators.required]\n      });\n      this.isEdit = false;\n      this.products$ = this.apiService.getProducts();\n      this.isLoading = false;\n    }\n    ngOnInit() {\n      this.route.params.subscribe(params => {\n        if (params['id']) {\n          this.isEdit = true;\n          this.Id = +params['id'];\n          this.loadWarehouseItem(this.Id);\n        }\n      });\n    }\n    loadWarehouseItem(id) {\n      this.isLoading = true;\n      this.apiService.getWarehouseItemsId(id).subscribe({\n        next: item => {\n          this.warehouseForm.patchValue({\n            product_id: item.product?.product_id,\n            quantity: item.product?.product_stocks,\n            location: item.location\n          });\n          this.isLoading = false;\n        },\n        error: err => {\n          this.toastr.error(err.error?.message || 'Failed to load item');\n          this.isLoading = false;\n        }\n      });\n    }\n    onSubmit() {\n      this.isLoading = true;\n      const items = this.warehouseForm.value;\n      this.apiService.getProductId(items.product_id).subscribe({\n        next: fullProduct => {\n          const itemData = {\n            product: fullProduct,\n            quantity: items.quantity ?? 0,\n            location: items.location ?? ''\n          };\n          if (this.isEdit && this.Id) {\n            this.apiService.updateWarehouse(this.Id, itemData).subscribe({\n              next: () => {\n                this.toastr.success('Item Updated Successfully');\n                this.router.navigate(['warehouse/items']);\n              },\n              error: err => {\n                this.toastr.error(err.error?.message || 'Update Failed');\n                this.isLoading = false;\n              }\n            });\n          } else {\n            this.apiService.createWarehouse(itemData).subscribe({\n              next: () => {\n                this.toastr.success('Item Created Successfully');\n                this.router.navigate(['warehouse/items']);\n              },\n              error: err => {\n                this.toastr.error(err.error?.message || 'Failed to create item');\n                this.isLoading = false;\n              }\n            });\n          }\n        }\n      });\n      if (this.warehouseForm.invalid) {\n        console.log('Invalid Data');\n        return;\n      }\n    }\n    logout() {\n      this.authService.logout();\n    }\n    static {\n      this.ɵfac = function WarehouseFormComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || WarehouseFormComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.ToastrService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: WarehouseFormComponent,\n        selectors: [[\"app-warehouse-form\"]],\n        decls: 41,\n        vars: 14,\n        consts: [[1, \"navbar\", \"navbar-expand-lg\", \"navbar-dark\", \"bg-dark\"], [1, \"container\"], [\"routerLink\", \"/\", 1, \"navbar-brand\"], [\"id\", \"navbarNav\", 1, \"collapse\", \"navbar-collapse\"], [1, \"navbar-nav\"], [1, \"nav-item\"], [\"routerLink\", \"/warehouse/items\", 1, \"nav-link\", \"active\"], [\"routerLink\", \"/warehouse/items\", 1, \"nav-link\", \"text-white\"], [\"id\", \"navbar-item\", 1, \"navbar-nav\"], [1, \"nav-link\", \"btn-primary\", \"btn\", 3, \"click\"], [1, \"container\", \"mt-4\"], [3, \"ngSubmit\", \"formGroup\"], [1, \"mb-3\"], [\"for\", \"product_id\", 1, \"form-label\"], [\"formControlName\", \"product_id\", \"id\", \"product_id\", 1, \"form-select\"], [\"value\", \"\"], [1, \"text-danger\"], [\"for\", \"location\", 1, \"form-label\"], [\"type\", \"text\", \"formControlName\", \"location\", \"id\", \"location\", 1, \"form-control\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", \"me-2\", 3, \"disabled\"], [\"type\", \"button\", \"routerLink\", \"/warehouse/items\", 1, \"btn\", \"btn-danger\"], [3, \"value\"]],\n        template: function WarehouseFormComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"nav\", 0)(1, \"div\", 1)(2, \"a\", 2);\n            i0.ɵɵtext(3, \"Inventory Management\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(4, \"div\", 3)(5, \"ul\", 4)(6, \"li\", 5)(7, \"a\", 6);\n            i0.ɵɵtext(8, \"Home\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(9, \"li\", 5)(10, \"a\", 7);\n            i0.ɵɵtext(11, \"Items\");\n            i0.ɵɵelementEnd()()()();\n            i0.ɵɵelementStart(12, \"ul\", 8)(13, \"li\", 5)(14, \"a\", 9);\n            i0.ɵɵlistener(\"click\", function WarehouseFormComponent_Template_a_click_14_listener() {\n              return ctx.logout();\n            });\n            i0.ɵɵtext(15, \"Logout\");\n            i0.ɵɵelementEnd()()()()();\n            i0.ɵɵelementStart(16, \"div\", 10)(17, \"p\");\n            i0.ɵɵtext(18);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(19, \"h2\");\n            i0.ɵɵtext(20);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(21, \"form\", 11);\n            i0.ɵɵlistener(\"ngSubmit\", function WarehouseFormComponent_Template_form_ngSubmit_21_listener() {\n              return ctx.onSubmit();\n            });\n            i0.ɵɵelementStart(22, \"div\", 12)(23, \"label\", 13);\n            i0.ɵɵtext(24, \"Product\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(25, \"select\", 14)(26, \"option\", 15);\n            i0.ɵɵtext(27, \"Select a product\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(28, WarehouseFormComponent_Conditional_28_Template, 2, 0);\n            i0.ɵɵpipe(29, \"async\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(30, WarehouseFormComponent_Conditional_30_Template, 2, 0, \"div\", 16);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(31, \"div\", 12)(32, \"label\", 17);\n            i0.ɵɵtext(33, \"Location\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(34, \"input\", 18);\n            i0.ɵɵtemplate(35, WarehouseFormComponent_Conditional_35_Template, 2, 0, \"div\", 16);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(36, \"button\", 19);\n            i0.ɵɵtemplate(37, WarehouseFormComponent_Conditional_37_Template, 1, 0, \"app-spinner\")(38, WarehouseFormComponent_Conditional_38_Template, 1, 1);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(39, \"button\", 20);\n            i0.ɵɵtext(40, \"Cancel\");\n            i0.ɵɵelementEnd()()();\n          }\n          if (rf & 2) {\n            let tmp_3_0;\n            let tmp_4_0;\n            let tmp_5_0;\n            let tmp_6_0;\n            let tmp_7_0;\n            i0.ɵɵadvance(18);\n            i0.ɵɵtextInterpolate1(\"\", ctx.Id, \"-ware\");\n            i0.ɵɵadvance(2);\n            i0.ɵɵtextInterpolate1(\"\", ctx.isEdit ? \"Edit\" : \"Add\", \" Warehouse Item\");\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"formGroup\", ctx.warehouseForm);\n            i0.ɵɵadvance(4);\n            i0.ɵɵclassProp(\"is-invalid\", ((tmp_3_0 = ctx.warehouseForm.get(\"product_id\")) == null ? null : tmp_3_0.invalid) && ((tmp_3_0 = ctx.warehouseForm.get(\"product_id\")) == null ? null : tmp_3_0.touched));\n            i0.ɵɵadvance(3);\n            i0.ɵɵconditional((tmp_4_0 = i0.ɵɵpipeBind1(29, 12, ctx.products$)) ? 28 : -1, tmp_4_0);\n            i0.ɵɵadvance(2);\n            i0.ɵɵconditional(((tmp_5_0 = ctx.warehouseForm.get(\"product_id\")) == null ? null : tmp_5_0.invalid) && ((tmp_5_0 = ctx.warehouseForm.get(\"product_id\")) == null ? null : tmp_5_0.touched) ? 30 : -1);\n            i0.ɵɵadvance(4);\n            i0.ɵɵclassProp(\"is-invalid\", ((tmp_6_0 = ctx.warehouseForm.get(\"location\")) == null ? null : tmp_6_0.invalid) && ((tmp_6_0 = ctx.warehouseForm.get(\"location\")) == null ? null : tmp_6_0.touched));\n            i0.ɵɵadvance();\n            i0.ɵɵconditional(((tmp_7_0 = ctx.warehouseForm.get(\"location\")) == null ? null : tmp_7_0.invalid) && ((tmp_7_0 = ctx.warehouseForm.get(\"location\")) == null ? null : tmp_7_0.touched) ? 35 : -1);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"disabled\", ctx.warehouseForm.invalid || ctx.isLoading);\n            i0.ɵɵadvance();\n            i0.ɵɵconditional(ctx.isLoading ? 37 : 38);\n          }\n        },\n        dependencies: [CommonModule, i3.AsyncPipe, ReactiveFormsModule, i4.ɵNgNoValidate, i4.NgSelectOption, i4.ɵNgSelectMultipleOption, i4.DefaultValueAccessor, i4.SelectControlValueAccessor, i4.NgControlStatus, i4.NgControlStatusGroup, i4.FormGroupDirective, i4.FormControlName, SpinnerComponent, RouterLink],\n        encapsulation: 2\n      });\n    }\n  }\n  return WarehouseFormComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}